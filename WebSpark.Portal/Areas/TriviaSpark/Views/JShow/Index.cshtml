@using TriviaSpark.JShow.Data
@model List<JShowVM>

@{
    ViewData["Title"] = "JShowVM - Interactive Trivia Experience Powered by GPT";
    ViewData["Description"] = "Learn how the JShowVM Controller and JShowService utilize the J-Show Builder GPT to create a dynamic trivia experience. Explore the JSON-powered game with unique themes and questions.";
    ViewData["Keywords"] = "JShowVM, trivia, interactive show, J-Show Builder GPT, JSON, ASP.NET Core";
}

<div class="container mt-4">
    <h2 class="mb-3">Select a Show</h2>

    <!-- Filter Navigation for Show Type -->
    <nav class="nav nav-pills mb-4">
        <a class="nav-link active" href="#" data-show-type="">All Types</a>
        @foreach (var type in Enum.GetValues(typeof(JShowType)))
        {
            <a class="nav-link" href="#" data-show-type="@type">@type</a>
        }
    </nav>

    <!-- Sort Controls -->
    <div class="d-flex justify-content-end mb-3">
        <div class="btn-group" role="group" aria-label="Sort by Theme">
            <button id="sortAscBtn" class="btn btn-outline-secondary">Sort by Theme A-Z</button>
            <button id="sortDescBtn" class="btn btn-outline-secondary">Sort by Theme Z-A</button>
        </div>
    </div>

    <!-- Show List -->
    <div id="showList" class="row row-cols-1 row-cols-md-2 g-4">
        @foreach (var show in Model)
        {
            <div class="col show-item" data-show-type="@show.Type" data-show-theme="@show.Theme">
                <div class="card shadow-sm">
                    <div class="card-body">
                        <h5 class="card-title">@show.Theme</h5>
                        <p class="card-text">
                            <strong>Description:</strong> @show.Description
                        </p>
                        <a href="/TriviaSpark/JShow/@show.Theme" alt="Play @show.Theme" class="btn btn-outline-primary">Play @show.Theme</a>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        // Function to filter shows based on show type
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                // Remove active class from all nav links and add to clicked one
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');

                var selectedType = this.getAttribute('data-show-type');
                var shows = document.querySelectorAll('.show-item');

                shows.forEach(function(show) {
                    var showType = show.getAttribute('data-show-type');
                    if (selectedType === '' || showType === selectedType) {
                        show.style.display = 'block';
                    } else {
                        show.style.display = 'none';
                    }
                });
            });
        });

        // Sort shows by theme in ascending order
        document.getElementById('sortAscBtn').addEventListener('click', function() {
            sortShows('asc');
        });

        // Sort shows by theme in descending order
        document.getElementById('sortDescBtn').addEventListener('click', function() {
            sortShows('desc');
        });

        // Function to sort shows by theme
        function sortShows(order) {
            var showList = document.getElementById('showList');
            var shows = Array.from(showList.getElementsByClassName('show-item'));

            shows.sort(function(a, b) {
                var themeA = a.getAttribute('data-show-theme').toLowerCase();
                var themeB = b.getAttribute('data-show-theme').toLowerCase();

                if (order === 'asc') {
                    return themeA.localeCompare(themeB);
                } else {
                    return themeB.localeCompare(themeA);
                }
            });

            // Clear and re-append sorted elements
            showList.innerHTML = '';
            shows.forEach(function(show) {
                showList.appendChild(show);
            });
        }
    </script>
}



<div class="container mt-4">
    <div class="row mt-5">
        <div class="col-md-8 offset-md-2">
            <h2>About the JShow Controller</h2>
            <p>
                The <strong>JShow Controller</strong> is the core of the JShow experience, designed to manage and present a variety of trivia shows. It interacts with the <strong>JShowService</strong> to retrieve show data from JSON files generated by the <a href="https://chatgpt.com/g/g-PbdFzh2Ke-j-show-builder-gpt" target="_blank">J-Show Builder GPT</a>.
            </p>
            <p>
                The JShow Controller's primary task is to list all available shows and allow users to select and view the content of each show. The data for each show, including the theme, air date, and detailed questions, is stored in JSON format and processed by the JShowService.
            </p>
        </div>
    </div>
    <div class="row mt-4">
        <div class="col-md-8 offset-md-2">
            <h2>How J-Show Builder GPT Works</h2>
            <p>
                The <a href="https://chatgpt.com/g/g-PbdFzh2Ke-j-show-builder-gpt" target="_blank">J-Show Builder GPT</a> is an AI-powered tool that creates the JSON files used by the JShow experience. Each JSON file represents a unique trivia show, complete with questions, categories, and themes.
            </p>
            <ul>
                <li><strong>Show Generation:</strong> The GPT generates each show's structure, including rounds, categories, and questions.</li>
                <li><strong>Custom Themes:</strong> It allows customization of themes and questions, making each show unique.</li>
                <li><strong>JSON Output:</strong> The generated content is saved as a JSON file, which the JShowService then reads and processes.</li>
            </ul>
            <p>
                The JSON files are stored in a designated folder and are dynamically read by the JShowService, ensuring a fresh and engaging trivia experience every time.
            </p>
        </div>
    </div>
    <div class="row mt-4">
        <div class="col-md-8 offset-md-2">
            <h2>Features of the JShowService</h2>
            <p>
                The <strong>JShowService</strong> is responsible for managing and delivering the content of the trivia shows. It provides several key features:
            </p>
            <ul>
                <li><strong>JSON File Management:</strong> Reads and parses JSON files to create a list of trivia shows, each with a unique show number.</li>
                <li><strong>Error Handling:</strong> Logs errors and continues processing other files, ensuring the system remains robust even if individual files are corrupted.</li>
                <li><strong>Dynamic Show Updates:</strong> Supports the addition of new shows without requiring a system restart, making it easy to update content on the fly.</li>
            </ul>
            <p>
                This service is essential for providing a seamless and dynamic trivia experience, enabling the JShow Controller to present a wide array of shows to the user.
            </p>
        </div>
    </div>
</div>